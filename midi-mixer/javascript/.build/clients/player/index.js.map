{"version":3,"names":["Client","launcher","filesystemPlugin","html","createLayout","renderEmptyTrack","renderTrack","renderParams","removeFromArray","config","window","SOUNDWORKS_CONFIG","main","$container","client","register","initScreensContainer","pluginManager","start","filesystem","get","$layout","tracks","stateManager","getCollection","globals","attach","onUpdate","requestUpdate","onAttach","onDetach","addComponent","render","map","track","execute","numClients","parseInt","URLSearchParams","location","search"],"sources":["../../../src/clients/player/index.js"],"sourcesContent":["import '@soundworks/helpers/polyfills.js';\nimport { Client } from '@soundworks/core/client.js';\nimport launcher from '@soundworks/helpers/launcher.js';\nimport filesystemPlugin from '@soundworks/plugin-filesystem/client.js';\n\nimport { html } from 'lit';\nimport createLayout from './views/layout.js';\nimport { renderEmptyTrack, renderTrack, renderParams} from './views/components.js';\n\nimport { removeFromArray } from './arrayHelper.js';\n\n// - General documentation: https://soundworks.dev/\n// - API documentation:     https://soundworks.dev/api\n// - Issue Tracker:         https://github.com/collective-soundworks/soundworks/issues\n// - Wizard & Tools:        `npx soundworks`\n\n/**\n * Grab the configuration object written by the server in the `index.html`\n */\nconst config = window.SOUNDWORKS_CONFIG;\n\n/**\n * If multiple clients are emulated you might to want to share some resources\n */\n// const audioContext = new AudioContext();\n\nasync function main($container) {\n  /**\n   * Create the soundworks client\n   */\n  const client = new Client(config);\n\n  launcher.register(client, { initScreensContainer: $container });\n\n  client.pluginManager.register('filesystem', filesystemPlugin);\n\n  /**\n   * Launch application\n   */\n  await client.start();\n\n  const filesystem = await client.pluginManager.get('filesystem');\n\n  const $layout = createLayout(client, $container);\n\n  const tracks = await client.stateManager.getCollection('track');\n  const globals = await client.stateManager.attach('globals');\n\n  tracks.onUpdate(() => $layout.requestUpdate());\n  tracks.onAttach(() => $layout.requestUpdate());\n  tracks.onDetach(() => $layout.requestUpdate());\n\n  // $layout.addComponent(renderParams(globals, filesystem));\n  $layout.addComponent({\n    render: () => {\n      return tracks.map(track => {\n        return track.get('disabled') ? renderEmptyTrack(track) : renderTrack(track);\n      });\n    },\n  });\n\n\n\n}\n\n// The launcher enables instanciation of multiple clients in the same page to\n// facilitate development and testing.\n// e.g. `http://127.0.0.1:8000?emulate=10` to run 10 clients side-by-side\nlauncher.execute(main, {\n  numClients: parseInt(new URLSearchParams(window.location.search).get('emulate')) || 1,\n});\n"],"mappings":"AAAA,OAAO,kCAAkC;AACzC,SAASA,MAAM,QAAQ,4BAA4B;AACnD,OAAOC,QAAQ,MAAM,iCAAiC;AACtD,OAAOC,gBAAgB,MAAM,yCAAyC;AAEtE,SAASC,IAAI,QAAQ,KAAK;AAC1B,OAAOC,YAAY,MAAM,mBAAmB;AAC5C,SAASC,gBAAgB,EAAEC,WAAW,EAAEC,YAAY,QAAO,uBAAuB;AAElF,SAASC,eAAe,QAAQ,kBAAkB;;AAElD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAMC,MAAM,GAAGC,MAAM,CAACC,iBAAiB;;AAEvC;AACA;AACA;AACA;;AAEA,eAAeC,IAAIA,CAACC,UAAU,EAAE;EAC9B;AACF;AACA;EACE,MAAMC,MAAM,GAAG,IAAId,MAAM,CAACS,MAAM,CAAC;EAEjCR,QAAQ,CAACc,QAAQ,CAACD,MAAM,EAAE;IAAEE,oBAAoB,EAAEH;EAAW,CAAC,CAAC;EAE/DC,MAAM,CAACG,aAAa,CAACF,QAAQ,CAAC,YAAY,EAAEb,gBAAgB,CAAC;;EAE7D;AACF;AACA;EACE,MAAMY,MAAM,CAACI,KAAK,CAAC,CAAC;EAEpB,MAAMC,UAAU,GAAG,MAAML,MAAM,CAACG,aAAa,CAACG,GAAG,CAAC,YAAY,CAAC;EAE/D,MAAMC,OAAO,GAAGjB,YAAY,CAACU,MAAM,EAAED,UAAU,CAAC;EAEhD,MAAMS,MAAM,GAAG,MAAMR,MAAM,CAACS,YAAY,CAACC,aAAa,CAAC,OAAO,CAAC;EAC/D,MAAMC,OAAO,GAAG,MAAMX,MAAM,CAACS,YAAY,CAACG,MAAM,CAAC,SAAS,CAAC;EAE3DJ,MAAM,CAACK,QAAQ,CAAC,MAAMN,OAAO,CAACO,aAAa,CAAC,CAAC,CAAC;EAC9CN,MAAM,CAACO,QAAQ,CAAC,MAAMR,OAAO,CAACO,aAAa,CAAC,CAAC,CAAC;EAC9CN,MAAM,CAACQ,QAAQ,CAAC,MAAMT,OAAO,CAACO,aAAa,CAAC,CAAC,CAAC;;EAE9C;EACAP,OAAO,CAACU,YAAY,CAAC;IACnBC,MAAM,EAAEA,CAAA,KAAM;MACZ,OAAOV,MAAM,CAACW,GAAG,CAACC,KAAK,IAAI;QACzB,OAAOA,KAAK,CAACd,GAAG,CAAC,UAAU,CAAC,GAAGf,gBAAgB,CAAC6B,KAAK,CAAC,GAAG5B,WAAW,CAAC4B,KAAK,CAAC;MAC7E,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;AAIJ;;AAEA;AACA;AACA;AACAjC,QAAQ,CAACkC,OAAO,CAACvB,IAAI,EAAE;EACrBwB,UAAU,EAAEC,QAAQ,CAAC,IAAIC,eAAe,CAAC5B,MAAM,CAAC6B,QAAQ,CAACC,MAAM,CAAC,CAACpB,GAAG,CAAC,SAAS,CAAC,CAAC,IAAI;AACtF,CAAC,CAAC"}
