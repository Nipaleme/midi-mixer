import matplotlib.pyplot as plt
import numpy as np
from scipy.optimize import curve_fit

figure, axis = plt.subplots(1, 2)

x = np.arange(1, 169, 1, dtype=int)

scaled_x = [(i / 168 * 127) for i in x]

#selection de deuxi√®me colonnes de notre dataset
# Y = np.arange(0, 127, 1, dtype=int)
y = [0.000032,0.000063,0.000126,0.000251,0.000501,0.001,0.001413,0.001995,0.002818,0.003981,0.005012,0.00631,0.007943,0.008913,0.01,0.01122,0.012589,0.014125,0.015849,0.016788,0.017783,0.018836,0.019953,0.021135,0.022387,0.023714,0.025119,0.026607,0.028184,0.029854,0.031623,0.033497,0.035481,0.037584,0.039811,0.04217,0.044668,0.047315,0.050119,0.053088,0.056234,0.059566,0.063096,0.065564,0.068129,0.070795,0.073564,0.076442,0.079433,0.08254,0.08577,0.089125,0.092612,0.096235,0.1,0.103912,0.107978,0.112202,0.116591,0.121153,0.125893,0.130818,0.135936,0.141254,0.14678,0.152522,0.158489,0.16469,0.171133,0.177828,0.184785,0.192014,0.199526,0.207332,0.215443,0.223872,0.232631,0.241732,0.251189,0.258523,0.266073,0.273842,0.281838,0.290068,0.298538,0.307256,0.316228,0.325462,0.334965,0.344747,0.354813,0.365174,0.375837,0.386812,0.398107,0.409732,0.421697,0.43401,0.446684,0.459727,0.473151,0.486968,0.501187,0.515822,0.530884,0.546387,0.562341,0.578762,0.595662,0.613056,0.630957,0.649382,0.668344,0.68786,0.707946,0.728618,0.749894,0.771792,0.794328,0.817523,0.841395,0.865964,0.891251,0.917276,0.944061,0.971628,1.,1.035142,1.071519,1.109175,1.148154,1.188502,1.230269,1.273503,1.318257,1.364583,1.412538,1.462177,1.513561,1.566751,1.62181,1.678804,1.737801,1.798871,1.862087,1.927525,1.995262,2.06538,2.137962,2.213095,2.290868,2.371374,2.454709,2.540973,2.630268,2.722701,2.818383,2.917427,3.02,3.12608,3.235936,3.349654,3.467369,3.589219,3.715353,3.845918,3.981072,4]


y_db = 20*np.log(y)

# CURVE_FIT

# popt, pcov = curve_fit(lambda t, a, b, c : a * np.exp(b*t) + c, scaled_x, y, p0=(106, 0.2437,6))
# popt, pcov = curve_fit(lambda t, a, b, c : a * pow(t,b) + c, scaled_x, y, p0=(106, 0.2437,6))
popt, pcov = curve_fit(lambda t, a, b : a + b * np.log(t), scaled_x, y_db, p0=(106, 0.2437))
a = popt[0]
b = popt[1]
# c = popt[2]
c = 0

# formulae from MAX
fitted_x = np.linspace(np.min(scaled_x),np.max(scaled_x), 100);
form_y_db = (pow((fitted_x*(0.007874015748)),0.2437)-1)*106+6
form_y = pow(10,form_y_db/20)

# fitted_y = a * np.exp(b * fitted_x) + c
# fitted_y = a * pow(fitted_x,b) + c
fitted_y = a + b * np.log(fitted_x)
fitted_y_db = 20*np.log(fitted_y)


print(a,b,c)

# axes1 = axis[0,0].axes()
# axes2 = axis[0,1].axes()
# axes1.grid()
# axes2.grid()
# plt.scatter(scaled_x,y)
axis[0].plot(fitted_x,form_y_db,color='g')
axis[0].plot(fitted_x,fitted_y_db,color='r')
axis[0].scatter(scaled_x,y_db)

axis[1].scatter(scaled_x,y)
axis[1].plot(fitted_x,form_y,color='g')
axis[1].plot(fitted_x,fitted_y,color='r')

plt.show()


